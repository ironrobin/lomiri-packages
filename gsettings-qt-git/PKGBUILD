# Maintainer: Ivan Semkin (ivan at semkin dot ru)

pkgname=gsettings-qt-git
_pkgname=gsettings-qt
pkgver=r272.v1.0.0_14_g37e0dfa
pkgrel=0
pkgdesc='Library to access GSettings from Qt'
url='https://github.com/ubports/gsettings-qt'
arch=(x86_64 i686 armv7h aarch64)
license=(LGPL)
depends=(qt5-base qt5-declarative)
makedepends=(git)
provides=(gsettings-qt)
replaces=(gsettings-qt)
source=('git+https://gitlab.com/ubports/core/gsettings-qt.git')
sha256sums=('SKIP')

#BUILDENV+=('!check') 

pkgver() {
  cd ${_pkgname}
  ver="r$(git rev-list --count HEAD).$(git describe --always)"
  echo "${ver//-/_}"            # only: hyphens â†’ underscores
}

build() {
  cd ${_pkgname}
  mkdir -p build
  cd build
  cmake -DCMAKE_INSTALL_PREFIX:PATH=/usr -DCMAKE_INSTALL_LIBDIR="lib/" -DCMAKE_INSTALL_SYSCONFDIR=/etc -DCMAKE_INSTALL_LOCALSTATEDIR=/var ..
}

package() {
  cd ${_pkgname}/build
  make DESTDIR="${pkgdir}/" install
  rm -rf "${pkgdir}"/usr/tests
}
# vim:set ts=2 sw=2 et:
