# Maintainer: Furkan Kardame <furkan@fkardame.com>

pkgname="hfd-service"
_pkgname="hfd-service"
pkgver=0.2.3
pkgrel=1
pkgdesc="Human Feedback Service for Lomiri UI"
arch=("i686" "x86_64" "aarch64")
url="https://github.com/ubports/hfd-service"
license=("GPL3")
depends=(qt5-base qt5-declarative qt5-feedback)
makedepends=("accountsservice" "deviceinfo" "cmake" "cmake-extras" "git")
source=("https://gitlab.com/ubports/development/core/hfd-service/-/archive/0.2.3/hfd-service-0.2.3.tar.gz")
md5sums=("SKIP")
options=("!emptydirs")
provides=("${_pkgname}")
conflicts=("${_pkgname}")

# pkgver() {
#   cd ${_pkgname}-${pkgver}
#   printf "r%s.%s" "$(git rev-list --count HEAD)" "$(git rev-parse --short HEAD)"
# }

prepare() 
{
  cd ${_pkgname}-${pkgver}
}

build()
{
   cd ${_pkgname}-${pkgver}
   mkdir -p build
   cd build
   cmake ../ -DCMAKE_INSTALL_PREFIX=/usr -DCMAKE_INSTALL_LIBEXECDIR=lib -DCMAKE_INSTALL_SYSCONFDIR=/etc -DENABLE_LIBHYBRIS=off
   make
}

package()
{
    cd ${_pkgname}-${pkgver}/build
    make DESTDIR="${pkgdir}" install
	  mv ${pkgdir}/usr/lib/qt5 ${pkgdir}/usr/lib/qt/
} 
